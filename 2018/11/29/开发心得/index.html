<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>开发心得 | 那咋爆裂啊</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="开发心得这里的每一点心得都是遇到的坑…… 游戏设计别限制玩家要怎么玩  解决方案技术栈 美术资源管理svn&#x2F;git-fls也可以建2个库，美术资源是Fork的库。这样。美术库只包含基本代码。代码库只包含基本允许场景。 其他资源管理使用git 文档使用  dokuwiki&#x2F; amwiki + git &#x2F;Confluence或代替品 项目管理 （禅道&#x2F;Redmi">
<meta property="og:type" content="article">
<meta property="og:title" content="开发心得">
<meta property="og:url" content="https://kumokyaku.github.io/2018/11/29/%E5%BC%80%E5%8F%91%E5%BF%83%E5%BE%97/index.html">
<meta property="og:site_name" content="那咋爆裂啊">
<meta property="og:description" content="开发心得这里的每一点心得都是遇到的坑…… 游戏设计别限制玩家要怎么玩  解决方案技术栈 美术资源管理svn&#x2F;git-fls也可以建2个库，美术资源是Fork的库。这样。美术库只包含基本代码。代码库只包含基本允许场景。 其他资源管理使用git 文档使用  dokuwiki&#x2F; amwiki + git &#x2F;Confluence或代替品 项目管理 （禅道&#x2F;Redmi">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-11-29T15:46:25.000Z">
<meta property="article:modified_time" content="2020-04-25T15:46:25.000Z">
<meta property="article:author" content="云却">
<meta property="article:tag" content="心得">
<meta property="article:tag" content="游戏">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="那咋爆裂啊" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/plugin/bganimation/bg.css">

  

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://avatars0.githubusercontent.com/u/15962980?s=400&amp;u=9f44d64956034405c51c0871949db00551133265&amp;v=4">
    <h2 class="author">云却</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>44</strong><br>文章</div></a>
      <a href="/categories"><div><strong>22</strong><br>分类</div></a>
      <a href="/tags"><div><strong>63</strong><br>标签</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main"><article id="post-开发心得" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/29/%E5%BC%80%E5%8F%91%E5%BF%83%E5%BE%97/" class="article-date">
  <time class="post-time" datetime="2018-11-29T15:46:25.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">29</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      开发心得
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/">游戏开发</a>
  </div>

          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="开发心得"><a href="#开发心得" class="headerlink" title="开发心得"></a>开发心得</h1><p>这里的每一点心得都是遇到的坑……</p>
<h2 id="游戏设计"><a href="#游戏设计" class="headerlink" title="游戏设计"></a>游戏设计</h2><pre><code>别限制玩家要怎么玩
</code></pre>
<h2 id="解决方案技术栈"><a href="#解决方案技术栈" class="headerlink" title="解决方案技术栈"></a>解决方案技术栈</h2><ul>
<li>美术资源管理svn&#x2F;git-fls<br>也可以建2个库，美术资源是Fork的库。这样。美术库只包含基本代码。代码库只包含基本允许场景。</li>
<li>其他资源管理使用git</li>
<li>文档使用  dokuwiki&#x2F; amwiki + git &#x2F;Confluence或代替品</li>
<li>项目管理 （禅道&#x2F;Redmine） + QQ邮箱 + webqq(调研中)</li>
<li>服务器使用docker Kitematic<ul>
<li>mysql mongodb</li>
<li>Jenkins</li>
</ul>
</li>
<li>使用.vsTemplate规范代码，创建VSIX</li>
</ul>
<span id="more"></span>

<h2 id="版本控制"><a href="#版本控制" class="headerlink" title="版本控制"></a>版本控制</h2><p>代码中完成Version类，对应版本配置文件。配置文件必须是可以差分的。<br>配置文件3个为默认配置。重写配置，指定版本重写配置。后面的配置文件盖前面的。<br>设计之初，任何功能都要根据版本可配置开启和关闭。每个功能条目配置上下限两个版本。<br>例如一个功能按钮是否显示，是否禁用，以应对功能随版本开闭。  </p>
<h2 id="工作区"><a href="#工作区" class="headerlink" title="工作区"></a>工作区</h2><p>创建工作区概念，客户端服务器各种自动化脚本放在一起，所有路径以配置的工作区路径+相对路径为准</p>
<h2 id="配置表"><a href="#配置表" class="headerlink" title="配置表"></a>配置表</h2><ul>
<li>ID、数字等不能有隐含信息，所有约束必须明文指出。<ul>
<li>错误示例：41，42，十位代表一个类别，个位代表子类别。</li>
</ul>
</li>
<li>元编程，为配置表每个字段生成一个接口，表结构类型是接口的组合、</li>
<li>配置表支持的类型应该为proto3的类型，兼容性更好</li>
</ul>
<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><ul>
<li>使用byte代替bool<br>少用bool 表示一个属性，尽量用byte。比如一个单位的一个属性时可不可见。由可见不可见改为可见级别。bool改为byte。这样可以设置不同级别的战争迷雾。<br>都是一个字节，开销差不多，判断用是否大于0。</li>
<li>使用int代替bool<br>int更通用，可以有负值，也方便内存对齐</li>
</ul>
<p><code>权衡之后，更倾向使用int表达一个属性</code></p>
<h2 id="代码细节-架构相关"><a href="#代码细节-架构相关" class="headerlink" title="代码细节 架构相关"></a>代码细节 架构相关</h2><h3 id="水平的叫层，垂直的叫模块。比如Megumin-Net网络模块，位于传输层和应用层。"><a href="#水平的叫层，垂直的叫模块。比如Megumin-Net网络模块，位于传输层和应用层。" class="headerlink" title="水平的叫层，垂直的叫模块。比如Megumin.Net网络模块，位于传输层和应用层。"></a><strong><code>水平的叫层，垂直的叫模块。比如Megumin.Net网络模块，位于传输层和应用层。</code></strong></h3><hr>
<p><strong><code>宗旨：尽量多分库，dll不怕多</code></strong>  </p>
<ul>
<li><p><code>大约是编程心得和杂项 </code><br>  基本4层：  </p>
<ul>
<li>4 软件层，程序入口。最开始向 2 注入IoC容器，或IoC配置。所有模块依赖的1中其他模块都需要延迟注入，避免循环引用问题。  </li>
<li>3 所有模块接口实现，通过依赖2实现延迟注入。  </li>
<li>2 Ioc容器接口，包含所有模块接口（如果使用反射可以省略4）  </li>
<li>1 最底层模块接口  </li>
<li>0 公共API接口，所有模块共用</li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  4  	---------------`软件层 IoC容器实现层`</span><br><span class="line"> /|\  </span><br><span class="line">3 | 3 	---------------`模块实现层`（这里可以分为多个子层）</span><br><span class="line">|\|/| </span><br><span class="line">| 2 |	---------------`IoC容器接口层`（这里可以分为多个子层）</span><br><span class="line">|/|\|</span><br><span class="line">1 | 1	---------------`模块接口层`</span><br><span class="line"> \|/</span><br><span class="line">  0 	---------------`通用接口层`</span><br></pre></td></tr></table></figure></li>
<li><p><code>代码</code></p>
<ul>
<li>不应该跨模块使用enum，除非enum声明在基础层。<ul>
<li>定义枚举一定要考虑是否会扩展。枚举扩展非常麻烦。</li>
<li>也要考虑是否有FlagAttribute。</li>
</ul>
</li>
<li>当你负责的模块使用了基础层的枚举，请在enum源码处注明你当前的模块，不能在源码处注明的，在文档中注明。（防止枚举变化带来大量改动）</li>
</ul>
</li>
<li><p>业务逻辑代码操作的MODEL，应该是接口或者虚类</p>
</li>
</ul>
<h2 id="接口设计"><a href="#接口设计" class="headerlink" title="接口设计"></a>接口设计</h2><ul>
<li>为了兼容AOT，接口定义的方法最好不要带泛型，可以改为泛型接口。IL2CPP或者其他静态生成器生成代码时，无法分析<code>接口中泛型方法</code>的<code>实现类的泛型方法</code>的<code>实际调用填充类型</code>。</li>
</ul>
<h2 id="类设计"><a href="#类设计" class="headerlink" title="类设计"></a>类设计</h2><ul>
<li><p>普通类</p>
<ul>
<li>如果一个类只为另一个类服务，那么他们应该写在一起，或者声明为内部类。<ul>
<li>例如：如果只有一个Book类，那么BookManager类则没有必要，应该写成Book的静态函数。</li>
</ul>
</li>
<li>声明 和 new 对象之前想想它的生命周期。  </li>
<li>动态的还是静态的</li>
<li>是不是唯一的</li>
<li>如果类的逻辑只使用到类的部分属性，那么应该可以考虑抽象出接口</li>
<li>逻辑只关心部分数据，不意味着要把对象的数据拆开。应该通过接口区分，而不是拆成各个sub子类。</li>
</ul>
<ul>
<li><code>不要用dynamic做形参类型</code></li>
</ul>
</li>
<li><p>通讯协议类<br>开发阶段协议都是用Json,通过string传递。减少迭代。对协议类接口化。<br>  发布阶段，将部分协议具体化，提高性能。</p>
<ul>
<li><p>通讯类命名<br>不建议在类名中加入前缀后缀，例如<del>reqest,</del>response，S2C<del>,C2S</del>,在实际使用中，类名会变得越来长，一个类也未必具有单一功能，S2C的类也可能S2S，失去前缀的意义反而带来歧义。</p>
</li>
<li><p>应答类  </p>
<ul>
<li><p>必须包含2个内容:  </p>
<ul>
<li><del>谁做了什么，即请求上下文；</del> Rpc机制解决了这个问题。</li>
<li>导致了什么结果，连锁结果应该放在同一个包中，避免时序错误 类似Race Condition。</li>
</ul>
</li>
<li><p>应答类中嵌套它对应的请求类是合理的。必须在 更小的包体 和 准确性 之间做出取舍。</p>
</li>
<li><p>如果特殊必要，不要使用增量的方式发送数据，每个消息包一定要独立完整。低频消息不在乎这点数据量。增量发送会导致接收端数据准确性问题。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p><code>业务逻辑应不应该直接使用协议类型？</code></p>
</li>
</ul>
<h2 id="究竟应该继承还是组合"><a href="#究竟应该继承还是组合" class="headerlink" title="究竟应该继承还是组合?"></a>究竟应该<code>继承</code>还是<code>组合</code>?</h2><ul>
<li>继承还是组合应该由两个类的<code>相似程度</code>决定,功能相差的多应该用耦合.<br>具体到百分比就是,如果类相似程度大于80%,用继承,小于80%用组合.</li>
<li>决定类A要不要继承B,看A与B相同功能占A总功能的百分比决定.<br>大于75%就继承.</li>
<li>组合时子元素不应该持有父元素引用,否则就是设计不合理,违反了高内聚低耦合.如果用到父,应该通过传参的方式.</li>
<li>继承和组合 父子关系是反过来的.</li>
</ul>
<h2 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h2><ul>
<li><p>方法宽度长度不应该大于一个屏幕</p>
</li>
<li><p>&#x2F;&#x2F;&#x2F;依据：大写开头是安全的，小写开头意味着你可能绕过某些Get&#x2F;Set逻辑  <a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/standard/design-guidelines/capitalization-conventions">https://docs.microsoft.com/zh-cn/dotnet/standard/design-guidelines/capitalization-conventions</a><br>  Pascal 类 结构 属性 字段 元组参数（本质为字段） 方法 (static readonly) const event<br>  camel 参数 </p>
</li>
<li><p>缩进 4空格</p>
</li>
<li><p>大括号换行</p>
</li>
<li><p>&#x3D; 后换行（代码过长时）</p>
</li>
<li><p>&#x3D;&gt;后换行（代码过长时）</p>
</li>
<li><p>不要使用#region，严重影响代码导航和滚动条。</p>
</li>
<li><p>团队协作时，如果不能统一格式。就<code>不允许</code>使用自动格式页面所有代码。这将导致代码无法追溯。</p>
</li>
</ul>
<h2 id="ID"><a href="#ID" class="headerlink" title="ID"></a>ID</h2><ul>
<li>ID 类唯一</li>
<li>UID 进程内唯一</li>
<li>GUID 全局唯一</li>
</ul>
<ul>
<li>对于玩家ID NPCID 怪物ID等实体，共用一个域使用long类型，向前兼容。<br>这里不能在乎int&#x2F;long的性能损失。</li>
</ul>
<h2 id="时间模块"><a href="#时间模块" class="headerlink" title="时间模块"></a>时间模块</h2><p>游戏功能系统设计之初就要将游戏暂停，后台恢复，掉线等情况考虑进去，比如移动，设计成根据时刻采样而不是位置的累加。<br>使用自己的update而不是unity的update，使用参数UpdateContent 包含 time realtimeSinceStartup frameCount updatemode等,可以指向unity的时间值，也可以重新实现这几个值。<br>自己实现时间模块可以根据功能自由的进行快进慢放操作，还可以提供可控制的相对时间戳，unity的time存在严重的设计足。  </p>
<p>为游戏设计几个状态：</p>
<ul>
<li>offline</li>
<li>normal</li>
<li>pause</li>
<li>pause2normal &#x2F;&#x2F;暂停到恢复正常的过程，用于处理网络中阻塞的数据。</li>
<li>willnormal &#x2F;&#x2F;进入normal的前一个时刻，通常为一帧</li>
<li>connect &#x2F;&#x2F;连接过程中。</li>
<li>reconnect &#x2F;&#x2F;重连过程中。区分连接和重连十分重要。</li>
</ul>
<p>通常处理功能模块有多种模式。如移动逻辑：<br>平滑移动，强制位置对齐，每次移动固定长度等。根据游戏进程的状态选用不同的移动模式，可以获得很好的断线重连效果。</p>
<h2 id="UI设计"><a href="#UI设计" class="headerlink" title="UI设计"></a>UI设计</h2><ul>
<li><p>UI大小（横屏）  </p>
<ul>
<li>画布大小 1280 * 720 （或者） 1334 * 750（iphone6尺寸）</li>
<li>切图大小尽量8的倍数，至少4的倍数。</li>
<li>对于移动端，一以红米Note4x 5.5英寸 1920*1080 像素为例：<ul>
<li>大Button，键盘按键的[3-4]&#x2F;2，6-7个为宜。</li>
<li>小Button，键盘按键的宽度,7-9为宜。</li>
<li>可选物品选单 水平排列半屏 4 个为宜，垂直排列 2.5-3.5 。</li>
</ul>
</li>
</ul>
<p>真实项目中可以把UI设计稿截个全屏图放入手机中感受一下。</p>
</li>
<li><p>UnityUI代码结构</p>
<ul>
<li><p>基于多层继承的代码结构。（设想）</p>
<table>
<thead>
<tr>
<th>继承层级</th>
<th>N+2</th>
<th>N+1</th>
<th>N</th>
<th>N-1</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td>预制体层</td>
<td>嵌套层</td>
<td>泛型层</td>
<td>总基类</td>
<td></td>
</tr>
<tr>
<td></td>
<td>实际挂在prefab上的脚本。</td>
<td>仅用于其他功能的嵌套引用。如果unity支持泛型序列化，那么这层完全可以取消</td>
<td>依赖于Model数据的逻辑（名字，堆叠）</td>
<td>不依赖于实际数据的逻辑</td>
<td></td>
</tr>
<tr>
<td>例:</td>
<td>ItemIconView1      第一版的物品图标脚本</td>
<td>(abstract)ItemTIconBase</td>
<td><code>ItemIcon&lt;T&gt;</code></td>
<td>(abstract)ItemIconCore</td>
<td>Monobehaviour</td>
</tr>
<tr>
<td></td>
<td>ItemIconView2      第二版的物品图标脚本</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>ShopItemView1         +(abstractItemTIconBase      商店物品脚本，包含了一个普通物品的图标，当由于需求变化ItemIconView出现大幅度修改时，由于这里引用的父类所以无需改动。</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
</li>
<li><p>基于接口的代码结构。</p>
<p>做到你的所有逻辑写在不继承于MonoBehavior的类里即可。</p>
</li>
</ul>
</li>
</ul>
<hr>
<hr>
<h2 id="对于文字，图片等资源的ID表示法问题"><a href="#对于文字，图片等资源的ID表示法问题" class="headerlink" title="对于文字，图片等资源的ID表示法问题"></a><code>对于文字，图片等资源的ID表示法问题</code></h2><p>由于需要文字国际化，我们通常在逻辑中使用一个Key（int&#x2F;string&#x2F;enum）表示一句话。那么在内存中我们什么时候将Key转化为字符串Value：</p>
<p>A. 在配置表加载完毕后，Model构建时将Key转化为Value。表现为Model中字段为Value(string)。</p>
<p>B. 在逻辑层面保持Key,在显示到屏幕的最后一刻，也就是View层将Key转化为String。表现为Model中字段为NameKey(Key)。</p>
<p>C. 在逻辑层面保持Key,在显示到屏幕的最后一刻，也就是View层将Key转化为图片等大型资源。表现为Model中字段为AssetKey(Key)。</p>
<table>
<thead>
<tr>
<th>各个方面优劣对比</th>
<th>A:Name(string)</th>
<th>B:NameKey(Key)</th>
<th>C：AssetKey(Key)</th>
</tr>
</thead>
<tbody><tr>
<td>内存占用</td>
<td>-</td>
<td>-</td>
<td>○</td>
</tr>
<tr>
<td>Debug难易</td>
<td>○</td>
<td>×</td>
<td>○</td>
</tr>
<tr>
<td>参数传递</td>
<td>-</td>
<td>-</td>
<td>○</td>
</tr>
<tr>
<td>跨模块API设计</td>
<td>○</td>
<td>×</td>
<td>×</td>
</tr>
</tbody></table>
<h2 id="结论：对于String使用A方式，对于图片，预制体等可延迟加载的大型资源，使用C方式。"><a href="#结论：对于String使用A方式，对于图片，预制体等可延迟加载的大型资源，使用C方式。" class="headerlink" title="结论：对于String使用A方式，对于图片，预制体等可延迟加载的大型资源，使用C方式。"></a>结论：对于String使用A方式，对于图片，预制体等可延迟加载的大型资源，使用C方式。</h2><hr>
<h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><ul>
<li>Q：游戏架构中MVC中M到底是什么？<ul>
<li>A：网络远端传来的数据；配置表；数据库。<br>  游戏设计中，数据来源总是从这三者之一出发，最终表现在屏幕上。<br>Input操作应该转化为指令，然后进入游戏逻辑，构成网络指令和操作指令的统一。</li>
<li>数据+逻辑应该做到可以脱离View运行。</li>
</ul>
</li>
</ul>
<h2 id="M-V-VM"><a href="#M-V-VM" class="headerlink" title="M-V-VM"></a>M-V-VM</h2><h2 id="Q-为什么要有ViewModel"><a href="#Q-为什么要有ViewModel" class="headerlink" title="Q: 为什么要有ViewModel?"></a>Q: 为什么要有ViewModel?</h2><p>A: 比如有一组物品，有个是否是当前正在被选中的属性。如果这个属性放在Model上，那么关闭View，再打开View，这个物品仍然是被选中的。<br>所以是否被选中应该是ViewModel的一个属性。打开View时，根据Model初始化ViewModel。<br>所以对于View层，Model不可见，只关心ViewModel即可。ViewModel是Model加其他View需要的属性的组合。</p>
<h2 id="Q：一个model可以对应多个ViewModel么？比如用于3D空间和用于UI？"><a href="#Q：一个model可以对应多个ViewModel么？比如用于3D空间和用于UI？" class="headerlink" title="Q：一个model可以对应多个ViewModel么？比如用于3D空间和用于UI？"></a>Q：一个model可以对应多个ViewModel么？比如用于3D空间和用于UI？</h2><h2 id="Q：ViewModel可以Clone-x2F-Fork么"><a href="#Q：ViewModel可以Clone-x2F-Fork么" class="headerlink" title="Q：ViewModel可以Clone&#x2F;Fork么?"></a>Q：ViewModel可以Clone&#x2F;Fork么?</h2><h2 id="Q-当model数据发生改变使用dirty轮询机制还是事件机制？"><a href="#Q-当model数据发生改变使用dirty轮询机制还是事件机制？" class="headerlink" title="Q: 当model数据发生改变使用dirty轮询机制还是事件机制？"></a>Q: 当model数据发生改变使用dirty轮询机制还是事件机制？</h2><ul>
<li>dirty机制<ul>
<li>只需要在ui界面需要刷新的去看看是否有脏标志  有脏标志就刷新下界面  </li>
<li>可能改变多次，但是只需要最新的</li>
<li>轮询可以控制频率和间隔，事件如果短时间巨量变动可能导致大量运算</li>
</ul>
</li>
</ul>
<h2 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h2><p>IDEDA -&gt; 确定所属功能 -&gt; 拆分功能明确依赖 -&gt; 明确依赖上下游并标准化接口 -&gt; IDEA.</p>
<h2 id="事务句柄-x2F-事务锁-x2F-ET6-0协程锁"><a href="#事务句柄-x2F-事务锁-x2F-ET6-0协程锁" class="headerlink" title="事务句柄&#x2F;事务锁&#x2F;ET6.0协程锁"></a>事务句柄&#x2F;事务锁&#x2F;ET6.0协程锁</h2><p>对于任何需要<code>异步执行/分段/防重入/互斥</code>的事务,应该采用先获取句柄在执行的设计，句柄在（多段）执行过程中传递，在执行结束后复位。句柄可以设计成泛型的，保存事务中间信息，尽量每次使用新句柄，而不是复用句柄，防止脏数据。</p>
<h2 id="对象池"><a href="#对象池" class="headerlink" title="对象池"></a>对象池</h2><p>要有全局任务控制。<br>对于各个功能，使用的频率决定相关功能对象池的权重，以此决定对象池长期保持对象的数量。<br>把需要加载的东西加入任务队列。控制好内存和帧率的平衡。<br>良好的设计应该是游戏应该知道什么时间段是性能占用低的时间。<br>比如打开全屏UI，通常性能非常充足。这个时候全局如果认为内存可用。就会分帧实例化对象池的对象。</p>
<h2 id="值类型在哪里分配内存"><a href="#值类型在哪里分配内存" class="headerlink" title="值类型在哪里分配内存"></a>值类型在哪里分配内存</h2><p>取决于声明位置,声明在方法内部,就在栈上. 声明在类的字段上,就在堆上.</p>
<h2 id="不要盲目解耦合"><a href="#不要盲目解耦合" class="headerlink" title="不要盲目解耦合"></a>不要盲目解耦合</h2><ul>
<li>调用方式与耦合程度：<br>类型强引用直接调用 &gt; 接口或多态调用 &gt; 事件委托调用 &gt; 字符串反射调用</li>
<li>以下几个情况适合解耦合： <ul>
<li>两个类型不在同一个程序集，被引用的程序集中希望调用引用它的程序集中的函数</li>
<li>两个类型不是由同一个程序员实现，互相不能有效沟通</li>
<li>类型在编码时未知，引用在编码时未知，由运行时动态生成</li>
</ul>
</li>
</ul>
<h2 id="编程三个核心技巧-理解每种技巧都是编程路上的分水岭"><a href="#编程三个核心技巧-理解每种技巧都是编程路上的分水岭" class="headerlink" title="编程三个核心技巧,理解每种技巧都是编程路上的分水岭."></a><code>编程三个核心技巧</code>,理解每种技巧都是编程路上的分水岭.</h2><ul>
<li>回调函数-&gt;委托事件</li>
<li>泛型</li>
<li>多线程-&gt;异步</li>
</ul>
<h2 id="编程境界"><a href="#编程境界" class="headerlink" title="编程境界"></a><code>编程境界</code></h2><ol>
<li>世间万物皆对象</li>
<li>世间万物皆数据<br>  解释：分得清什么是数据什么是逻辑，知道数据和逻辑可以互相转化，进而复用。<br>  例子：各种配置表。</li>
<li>标准化<br>  解释：任何事物都需要不停的迭代发展。标准化是快速迭代的必要条件。 </li>
<li><a target="_blank" rel="noopener" href="https://ferd.ca/complexity-has-to-live-somewhere.html">复杂度不会消失，只会转移。</a><code>同时也意味着可以转移</code>。<ul>
<li>标准化是一个明确的边界，将复杂度分离到各个子模块中。  </li>
<li>需求的最小复杂度是存在的，实现的复杂度总是大于最小复杂度。错误的设计会增加不必要的复杂度。</li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/138145081">消灭重复</a>与不必要复杂度的引入，比如Util函数中的十多个传参。</li>
</ul>
</li>
<li>数据是存在，逻辑是变化。  <blockquote>
<p>以前以为发明二进制的人很牛逼，用0和1就能表达整个世界，洞悉了世界的本质。但其实不是的，二进制也好，十进制也好，只是表达方式的不同。计算机使用二级制，是因为物理材料容易实现，如果材料合适，使用三进制，十进制都是可以的。<br> <code>数据与逻辑不因表达方式不同而改变。</code>花言巧语不能改变事物本质。<br> 数据与逻辑才是万物的基石，二进制不是。  </p>
</blockquote>
<blockquote>
<p>程序的本质就是数据和逻辑。要写出更通用和准确的逻辑，就需要更高级的数据描述方式。interface和class具有局限性。</p>
</blockquote>
</li>
<li>还没有悟出来……</li>
</ol>
<h1 id="工具链"><a href="#工具链" class="headerlink" title="工具链"></a>工具链</h1><p>经验法则： 美术素材只能用工具生成中间素材，不能生成最终素材，因为对于最终素材90%的情况需要手动调整，挂载脚本。一旦由工具重新生成，手动调整部分会丢失，如果工具要保留手动调整部分，要做大量工作。</p>
<h1 id="unity客户端可以开启HTTP监听，然后远程发送调试指令，也可以嵌入到控制台"><a href="#unity客户端可以开启HTTP监听，然后远程发送调试指令，也可以嵌入到控制台" class="headerlink" title="unity客户端可以开启HTTP监听，然后远程发送调试指令，也可以嵌入到控制台"></a>unity客户端可以开启HTTP监听，然后远程发送调试指令，也可以嵌入到控制台</h1><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">StartHttpDebug</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    HttpListener listener = <span class="keyword">new</span> HttpListener();</span><br><span class="line">    Debug.Log(<span class="string">$&quot;开启HTTP66666 Debug监听  IsSupported:<span class="subst">&#123;HttpListener.IsSupported&#125;</span>&quot;</span>);</span><br><span class="line">    listener.AuthenticationSchemes = AuthenticationSchemes.Anonymous;<span class="comment">//指定身份验证 Anonymous匿名访问</span></span><br><span class="line">    listener.Prefixes.Add(<span class="string">&quot;http://+:66666/&quot;</span>);</span><br><span class="line">    listener.Start();</span><br><span class="line">    StartRecvAsync(listener);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">StartRecvAsync</span>(<span class="params">HttpListener listener</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> context = <span class="keyword">await</span> listener.GetContextAsync();</span><br><span class="line">    StartRecvAsync(listener);</span><br><span class="line">    <span class="built_in">string</span> rawUrl = context.Request.RawUrl;</span><br><span class="line">    <span class="keyword">if</span> (rawUrl == <span class="string">&quot;/favicon.ico&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        rawUrl = rawUrl.Substring(<span class="number">1</span>, rawUrl.Length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Excute(rawUrl);</span><br><span class="line">    <span class="comment">//使用Writer输出http响应代码,UTF8格式</span></span><br><span class="line">    <span class="keyword">using</span> (StreamWriter writer = <span class="keyword">new</span> StreamWriter(context.Response.OutputStream, Encoding.UTF8))</span><br><span class="line">    &#123;</span><br><span class="line">        writer.Write(<span class="string">&quot;&lt;HTML&gt;&lt;BODY&gt; 收到指令 &lt;/BODY&gt;&lt;/HTML&gt;&quot;</span>);</span><br><span class="line">        writer.Close();</span><br><span class="line">        context.Response.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://kumokyaku.github.io/2018/11/29/%E5%BC%80%E5%8F%91%E5%BF%83%E5%BE%97/" data-id="clfcbw3bf0021pwvl23n6g8us" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BF%83%E5%BE%97/" rel="tag">心得</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%B8%E6%88%8F/" rel="tag">游戏</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/11/29/%E5%A6%82%E4%BD%95%E4%B9%A0%E6%83%AF%E5%9C%A8%E5%88%AB%E4%BA%BA%E7%9A%84%E5%9F%BA%E7%A1%80%E4%B8%8A%E5%BC%80%E5%A7%8B/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          如何习惯在别人的基础上开始
        
      </div>
    </a>
  
  
    <a href="/2018/11/29/%E6%90%9E%E7%AC%91%E6%98%B5%E7%A7%B0/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">搞笑昵称</div>
    </a>
  
</nav>

  
</article>



</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">那咋爆裂啊</h1>
    <h2 class="blog-subtitle"></h2>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://avatars0.githubusercontent.com/u/15962980?s=400&amp;u=9f44d64956034405c51c0871949db00551133265&amp;v=4">
    <h2 class="author">云却</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>44</strong><br>文章</div></a>
      <a href="/categories"><div><strong>22</strong><br>分类</div></a>
      <a href="/tags"><div><strong>63</strong><br>标签</div></a>
    </div>



    <div class="social-link">
      
        <a class="hvr-bounce-in" href="https://github.com/KumoKyaku" target="_blank" title="Github">
          Github
        </a>
      
    </div>

    <div class="friend-link">
      <h2>友情链接</h2>
      
        <a class="hvr-bounce-in" href="http://dumoedss.cc/?p=211" target="_blank" title="萌就是正义">
          萌就是正义
        </a>
      
    </div>
  </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2022 - 2023 云却<br>
      由<a href="http://hexo.io/" target="_blank">Hexo</a>强力驱动 | 
      主题-<a target="_blank" rel="noopener" href="https://github.com/ShanaMaid/hexo-theme-shana">Shana</a>
      
    </div>
    
  </div>
</footer>
    </div>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/wow/0.1.6/wow.min.js"></script>
<script>
new WOW().init();
</script>   


  
<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">

  
<script src="/plugin/fancybox/jquery.fancybox.pack.js"></script>




  
<link rel="stylesheet" href="/plugin/galmenu/GalMenu.css">

  
<script src="/plugin/galmenu/GalMenu.js"></script>

  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a href="/" title="" class="menuItem">首页</a>
          
            <a href="/tags" title="" class="menuItem">标签</a>
          
            <a href="/categories" title="" class="menuItem">分类</a>
          
            <a href="/archives" title="" class="menuItem">归档</a>
          
            <a href="/xxxxxxxxx" title="" class="menuItem">xxx</a>
          
            <a href="/xxxxxxx" title="" class="menuItem">xxxx</a>
          
        </div>
        
          <audio id="audio" src="#"></audio>
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>苟利</span></li> 
    <li><span>国家</span></li> 
    <li><span>生死以</span></li> 
    <li><span>岂能</span></li> 
    <li><span>祸福</span></li> 
    <li><span>趋避之</span></li> 
  </ul>
</section>

<script src="/js/script.js"></script>




  </div>
</body>
</html>